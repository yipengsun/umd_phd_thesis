\section{MC simulation}
\label{ref:sel:mc}

A large number of simulated events are used to model the signal, normalization,
and partially reconstructed backgrounds in data.
To reduce simulation time, tracker-only (TO) MC, which has all but the tracking
system of the detector turned off (set to passive material), are used.
Additional small full simulation (FullSim) samples are produced for the year
2016 to aid emulations of the missing detector responses (mainly trigger).
The emulation procedures are discussed in \cref{ref:mc-emulation}.

MC samples used for both \Dz and \Dstar channels are listed in
\cref{tab:mc-d0-dst}, with TO and FullSim numbers listed separately.
Some samples contribute to both channels due to feed down\footnote{
    This means that the selection procedure was unable to find the
    additional slow \pion required to reconstruct a \Dstar, thus only a
    \Dz was constructed and the candidate is \emph{feed down} from \Dstar
    channel to \Dz channel.
}, and are indicated in the same table\footnote{
    As a remark, the TO and FullSim have different simulation conditions,
    which are denoted by \textbf{SimXXX}.
    The differences are technical and can be ignored for this thesis.
}.


\afterpage{
    \input{selection-tab-mc-samples.tex}
}


Both TO and FullSim MC samples are loosely filtered to keep events in LHCb
acceptance, mostly to save storage space,
with filtering cuts listed in \cref{tab:gen-cut}.
%%%%
The online and offline selection are aligned with that of the right-sign sample,
with the understanding that trigger and PID responses are emulated offline and
applied as weights (for L0 trigger and PID) and cuts
(for HLT1 and HLT2 trigger).
%%%%
Additional truth level requirements\footnote{
    For MC samples, each reconstructed particle is associated with a true
    particle ID. The truth level requirements (truth-matching) demands that
    the true ID is the same as specified in the simulation.
    For example, for a candidate from  MC $\Bm \rightarrow \Dz\mun$ decay,
    the reconstructed \muon is required to have a true ID of a MC true \muon.
} are placed to ensure the selected decay
chain is compatible with simulation specification.
This effectively removes ghost
(combinations of random track segments in the detector tracking system)
and misidentified tracks,
providing a consistent modeling and ensuring orthogonality between MC samples.

\begin{table}
    \caption{List of MC filtering cuts at generator level.}
    \label{tab:gen-cut}
    \centering
    \begin{tabular}{c|rll}
        \toprule
        {\bf Particle}  & {\bf Variable}               & {\bf Cuts}      \\
        \midrule
        \kaon, \pion    & $p_x / p_z$                  & -0.38--0.38     \\
                        & $p_y / p_z$                  & -0.28--0.28     \\
                        & $\theta$                     & $> 0.01$~rad    \\
                        & \pt                          & $> 250$~MeV     \\
        \midrule
        \muon           & $p_x / p_z$                  & -0.38--0.38     \\
                        & $p_y / p_z$                  & -0.28--0.28     \\
                        & $\theta$                     & $> 0.01$~rad    \\
                        & \ptot                        & $> 2950$~MeV    \\
        \midrule
        \Dz             & \pt                          & $> 15$~GeV      \\
                        & \ptot                        & $> 2450$~MeV    \\
        \bottomrule
    \end{tabular}
\end{table}

The highly excited (heavy) $D^{**}$ and $DDX$ MC are cocktails,
that is, samples containing a mixture of different simulated decay modes,
with their compositions as listed in \cite{LHCb-ANA-2020-056}.
%%%%
The heavy $D^{**}$ MC suffer from the problem that the
$\Dstst \rightarrow D^{(*)} \piz\piz$ decays
are not simulated,
inconsistent with the branching fraction expectations from isospin symmetry.
The missing $\piz \piz$ contribution is modeled by randomly selecting
$\frac{1}{3}$ of $\pip \pim$ candidates and not applying the veto on additional
tracks.
